---
permalink: troubleshoot/troubleshoot-low-watermark-alert.html 
sidebar: sidebar 
keywords: troubleshoot low soft read-only watermark override alert, optimized watermarks 
summary: 'Si vous utilisez des valeurs personnalisées pour les filigranes de volume de stockage, vous devrez peut-être résoudre l"alerte de remplacement du filigrane en lecture seule faible.  Si possible, vous devez mettre à jour votre système pour commencer à utiliser les valeurs optimisées.' 
---
= Dépannage des alertes de remplacement du filigrane en lecture seule faible
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Si vous utilisez des valeurs personnalisées pour les filigranes de volume de stockage, vous devrez peut-être résoudre l'alerte *Remplacement du filigrane en lecture seule faible*.  Si possible, vous devez mettre à jour votre système pour commencer à utiliser les valeurs optimisées.

Dans les versions précédentes, les troislink:../admin/what-storage-volume-watermarks-are.html["filigranes de volume de stockage"] les paramètres globaux étaient les mêmes valeurs appliquées à chaque volume de stockage sur chaque nœud de stockage.  À partir de StorageGRID 11.6, le logiciel peut optimiser ces filigranes pour chaque volume de stockage, en fonction de la taille du nœud de stockage et de la capacité relative du volume.

Lorsque vous effectuez une mise à niveau vers StorageGRID 11.6 ou une version ultérieure, les filigranes optimisés en lecture seule et en lecture-écriture sont automatiquement appliqués à tous les volumes de stockage, sauf si l'une des conditions suivantes est vraie :

* Votre système est proche de sa capacité maximale et ne pourrait pas accepter de nouvelles données si des filigranes optimisés étaient appliqués.  StorageGRID ne modifiera pas les paramètres de filigrane dans ce cas.
* Vous avez précédemment défini l’un des filigranes du volume de stockage sur une valeur personnalisée.  StorageGRID ne remplacera pas les paramètres de filigrane personnalisés par des valeurs optimisées.  Cependant, StorageGRID peut déclencher l'alerte *Remplacement du filigrane en lecture seule faible* si votre valeur personnalisée pour le filigrane en lecture seule logicielle du volume de stockage est trop petite.




== Comprendre l'alerte

Si vous utilisez des valeurs personnalisées pour les filigranes de volume de stockage, l'alerte *Remplacement du filigrane en lecture seule faible* peut être déclenchée pour un ou plusieurs nœuds de stockage.

Chaque instance de l'alerte indique que la valeur personnalisée du filigrane en lecture seule du volume de stockage est inférieure à la valeur optimisée minimale pour ce nœud de stockage.  Si vous continuez à utiliser le paramètre personnalisé, le nœud de stockage risque de manquer cruellement d'espace avant de pouvoir passer en toute sécurité à l'état de lecture seule.  Certains volumes de stockage peuvent devenir inaccessibles (démontés automatiquement) lorsque le nœud atteint sa capacité.

Par exemple, supposons que vous ayez précédemment défini le filigrane de lecture seule logicielle du volume de stockage sur 5 Go.  Supposons maintenant que StorageGRID a calculé les valeurs optimisées suivantes pour les quatre volumes de stockage du nœud de stockage A :

[cols="2a,2a"]
|===


 a| 
Volume 0
 a| 
12 Go



 a| 
Volume 1
 a| 
12 Go



 a| 
Volume 2
 a| 
11 Go



 a| 
Volume 3
 a| 
15 Go

|===
L'alerte *Remplacement du filigrane en lecture seule faible* est déclenchée pour le nœud de stockage A, car votre filigrane personnalisé (5 Go) est inférieur à la valeur optimisée minimale pour tous les volumes de ce nœud (11 Go).  Si vous continuez à utiliser le paramètre personnalisé, le nœud risque de manquer cruellement d'espace avant de pouvoir passer en toute sécurité à l'état de lecture seule.



== Résoudre l'alerte

Suivez ces étapes si une ou plusieurs alertes de *remplacement du filigrane en lecture seule faible* ont été déclenchées.  Vous pouvez également utiliser ces instructions si vous utilisez actuellement des paramètres de filigrane personnalisés et souhaitez commencer à utiliser des paramètres optimisés même si aucune alerte n'a été déclenchée.

.Avant de commencer
* Vous avez terminé la mise à niveau vers StorageGRID 11.6 ou supérieur.
* Vous êtes connecté au Grid Manager à l'aide d'unlink:../admin/web-browser-requirements.html["navigateur Web pris en charge"] .
* Vous avez lelink:../admin/admin-group-permissions.html["Autorisation d'accès root"] .


.À propos de cette tâche
Vous pouvez résoudre l'alerte *Remplacement du filigrane en lecture seule faible* en mettant à jour les paramètres de filigrane personnalisés avec les nouveaux remplacements de filigrane.  Toutefois, si un ou plusieurs nœuds de stockage sont presque pleins ou si vous avez des exigences ILM particulières, vous devez d'abord afficher les filigranes de stockage optimisés et déterminer s'il est sûr de les utiliser.



=== Évaluer l'utilisation des données d'objet pour l'ensemble de la grille

.Étapes
. Sélectionnez *NODES*.
. Pour chaque site de la grille, développez la liste des nœuds.
. Consultez les valeurs de pourcentage affichées dans la colonne *Données d’objet utilisées* pour chaque nœud de stockage sur chaque site.
+
image::../media/nodes_page_object_data_used_with_alert.png[Page de nœuds affichant les données d'objet utilisées pour 3 SN]

. Suivez l’étape appropriée :
+
.. Si aucun des nœuds de stockage n'est presque plein (par exemple, toutes les valeurs *Données d'objet utilisées* sont inférieures à 80 %), vous pouvez commencer à utiliser les paramètres de remplacement. Aller à<<use-optimized-watermarks,Utiliser des filigranes optimisés>> .
.. Si les règles ILM utilisent un comportement d'ingestion strict ou si des pools de stockage spécifiques sont presque pleins, effectuez les étapes décrites dans<<view-optimized-watermarks,Afficher les filigranes de stockage optimisés>> et<<determine-optimized-watermarks,Déterminez si vous pouvez utiliser des filigranes optimisés>> .






=== [[view-optimized-watermarks]]Afficher les filigranes de stockage optimisés

StorageGRID utilise deux mesures Prometheus pour afficher les valeurs optimisées qu'il a calculées pour le filigrane en lecture seule du volume de stockage.  Vous pouvez afficher les valeurs optimisées minimales et maximales pour chaque nœud de stockage de votre grille.

.Étapes
. Sélectionnez *SUPPORT* > *Outils* > *Métriques*.
. Dans la section Prometheus, sélectionnez le lien pour accéder à l'interface utilisateur de Prometheus.
. Pour voir le filigrane en lecture seule minimal recommandé, entrez la métrique Prometheus suivante et sélectionnez *Exécuter* :
+
`storagegrid_storage_volume_minimum_optimized_soft_readonly_watermark`

+
La dernière colonne affiche la valeur optimisée minimale du filigrane en lecture seule souple pour tous les volumes de stockage sur chaque nœud de stockage.  Si cette valeur est supérieure au paramètre personnalisé pour le filigrane en lecture seule logicielle du volume de stockage, l'alerte *Remplacement du filigrane en lecture seule faible* est déclenchée pour le nœud de stockage.

. Pour voir le filigrane en lecture seule maximal recommandé, entrez la métrique Prometheus suivante et sélectionnez *Exécuter* :
+
`storagegrid_storage_volume_maximum_optimized_soft_readonly_watermark`

+
La dernière colonne affiche la valeur optimisée maximale du filigrane en lecture seule pour tous les volumes de stockage sur chaque nœud de stockage.

. [[maximum_optimized_value]]Notez la valeur optimisée maximale pour chaque nœud de stockage.




=== [[determine-optimized-watermarks]]Déterminez si vous pouvez utiliser des filigranes optimisés

.Étapes
. Sélectionnez *NODES*.
. Répétez ces étapes pour chaque nœud de stockage en ligne :
+
.. Sélectionnez *_Nœud de stockage_* > *Stockage*.
.. Faites défiler jusqu’au tableau Magasins d’objets.
.. Comparez la valeur *Disponible* pour chaque magasin d'objets (volume) au filigrane optimisé maximal que vous avez noté pour ce nœud de stockage.


. Si au moins un volume sur chaque nœud de stockage en ligne dispose de plus d'espace disponible que le filigrane optimisé maximal pour ce nœud, accédez à<<use-optimized-watermarks,Utiliser des filigranes optimisés>> pour commencer à utiliser les filigranes optimisés.
+
Sinon, étendez la grille dès que possible.  Soitlink:../expand/adding-storage-volumes-to-storage-nodes.html["ajouter des volumes de stockage"] à un nœud existant oulink:../expand/adding-grid-nodes-to-existing-site-or-adding-new-site.html["ajouter de nouveaux nœuds de stockage"] .  Ensuite, allez à<<use-optimized-watermarks,Utiliser des filigranes optimisés>> pour mettre à jour les paramètres du filigrane.

. Si vous devez continuer à utiliser des valeurs personnalisées pour les filigranes du volume de stockage,link:../monitor/silencing-alert-notifications.html["silence"] oulink:../monitor/disabling-alert-rules.html["désactiver"] l'alerte *Remplacement du filigrane en lecture seule faible*.
+

NOTE: Les mêmes valeurs de filigrane personnalisées sont appliquées à chaque volume de stockage sur chaque nœud de stockage.  L'utilisation de valeurs inférieures à celles recommandées pour les filigranes de volume de stockage peut entraîner l'inaccessibilité de certains volumes de stockage (démontage automatique) lorsque le nœud atteint sa capacité.





=== [[use-optimized-watermarks]]Utiliser des filigranes optimisés

.Étapes
. Accédez à *SUPPORT* > *Autre* > *Filigranes de stockage*.
. Cochez la case *Utiliser les valeurs optimisées*.
. Sélectionnez *Enregistrer*.


Les paramètres de filigrane de volume de stockage optimisés sont désormais en vigueur pour chaque volume de stockage, en fonction de la taille du nœud de stockage et de la capacité relative du volume.
