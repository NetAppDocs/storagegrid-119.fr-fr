---
permalink: monitor/email-alert-notifications.html 
sidebar: sidebar 
keywords: how to disable alert rules, how to remove a custom alert rule 
summary: 'Si vous souhaitez que des notifications par e-mail soient envoyées lorsque des alertes se produisent, vous devez fournir des informations sur votre serveur SMTP.  Vous devez également saisir les adresses e-mail des destinataires des notifications d"alerte.' 
---
= Configurer des notifications par e-mail pour les alertes
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
Si vous souhaitez que des notifications par e-mail soient envoyées lorsque des alertes se produisent, vous devez fournir des informations sur votre serveur SMTP.  Vous devez également saisir les adresses e-mail des destinataires des notifications d'alerte.

.Avant de commencer
* Vous êtes connecté au Grid Manager à l'aide d'unlink:../admin/web-browser-requirements.html["navigateur Web pris en charge"] .
* Vous avez lelink:../admin/admin-group-permissions.html["Gérer les alertes ou l'autorisation d'accès root"] .


.À propos de cette tâche
La configuration de messagerie utilisée pour les notifications d'alerte n'est pas utilisée pour les packages AutoSupport .  Cependant, vous pouvez utiliser le même serveur de messagerie pour toutes les notifications.

Si votre déploiement StorageGRID inclut plusieurs nœuds d'administration, le nœud d'administration principal est l'expéditeur préféré pour les notifications d'alerte, les packages AutoSupport et les interruptions et informations SNMP.  Si le nœud d’administration principal devient indisponible, des notifications sont temporairement envoyées par d’autres nœuds d’administration. Voir link:../primer/what-admin-node-is.html["Qu'est-ce qu'un nœud d'administration ?"] .

.Étapes
. Sélectionnez *ALERTES* > *Configuration de la messagerie électronique*.
+
La page de configuration de la messagerie électronique s’affiche.

. Cochez la case *Activer les notifications par e-mail* pour indiquer que vous souhaitez que des e-mails de notification soient envoyés lorsque les alertes atteignent les seuils configurés.
+
Les sections Serveur de messagerie (SMTP), Sécurité de la couche de transport (TLS), Adresses de messagerie et Filtres s'affichent.

. Dans la section Serveur de messagerie (SMTP), saisissez les informations dont StorageGRID a besoin pour accéder à votre serveur SMTP.
+
Si votre serveur SMTP nécessite une authentification, vous devez fournir un nom d’utilisateur et un mot de passe.

+
[cols="1a,2a"]
|===
| Champ | Entrer 


 a| 
Serveur de messagerie
 a| 
Le nom de domaine complet (FQDN) ou l'adresse IP du serveur SMTP.



 a| 
Port
 a| 
Le port utilisé pour accéder au serveur SMTP.  Doit être compris entre 1 et 65535.



 a| 
Nom d'utilisateur (facultatif)
 a| 
Si votre serveur SMTP nécessite une authentification, saisissez le nom d'utilisateur avec lequel vous souhaitez vous authentifier.



 a| 
Mot de passe (facultatif)
 a| 
Si votre serveur SMTP nécessite une authentification, saisissez le mot de passe pour vous authentifier.

|===
. Dans la section Adresses e-mail, saisissez les adresses e-mail de l’expéditeur et de chaque destinataire.
+
.. Pour l'*Adresse e-mail de l'expéditeur*, spécifiez une adresse e-mail valide à utiliser comme adresse d'expéditeur pour les notifications d'alerte.
+
Par exemple :  `storagegrid-alerts@example.com`

.. Dans la section Destinataires, saisissez une adresse e-mail pour chaque liste de diffusion ou personne qui doit recevoir un e-mail lorsqu'une alerte se produit.
+
Sélectionnez l'icône plusimage:../media/icon_plus_sign_black_on_white.gif["icône plus"] pour ajouter des destinataires.



. Si Transport Layer Security (TLS) est requis pour les communications avec le serveur SMTP, sélectionnez *Exiger TLS* dans la section Transport Layer Security (TLS).
+
.. Dans le champ *Certificat CA*, indiquez le certificat CA qui sera utilisé pour vérifier l'identité du serveur SMTP.
+
Vous pouvez copier et coller le contenu dans ce champ, ou sélectionner *Parcourir* et sélectionner le fichier.

+
Vous devez fournir un fichier unique contenant les certificats de chaque autorité de certification émettrice intermédiaire (CA).  Le fichier doit contenir chacun des fichiers de certificat CA codés en PEM, concaténés dans l'ordre de la chaîne de certificats.

.. Cochez la case *Envoyer un certificat client* si votre serveur de messagerie SMTP exige que les expéditeurs de messagerie fournissent des certificats clients pour l'authentification.
.. Dans le champ *Certificat client*, indiquez le certificat client codé PEM à envoyer au serveur SMTP.
+
Vous pouvez copier et coller le contenu dans ce champ, ou sélectionner *Parcourir* et sélectionner le fichier.

.. Dans le champ *Clé privée*, saisissez la clé privée du certificat client dans un encodage PEM non chiffré.
+
Vous pouvez copier et coller le contenu dans ce champ, ou sélectionner *Parcourir* et sélectionner le fichier.

+

NOTE: Si vous devez modifier la configuration de la messagerie électronique, sélectionnez l'icône en forme de crayonimage:../media/icon_edit_tm.png["Modifier l'icône"] pour mettre à jour ce champ.



. Dans la section Filtres, sélectionnez les niveaux de gravité des alertes qui doivent entraîner des notifications par e-mail, sauf si la règle d'une alerte spécifique a été désactivée.
+
[cols="1a,2a"]
|===
| Gravité | Description 


 a| 
Mineur, majeur, critique
 a| 
Une notification par courrier électronique est envoyée lorsque la condition mineure, majeure ou critique d'une règle d'alerte est remplie.



 a| 
Majeur, critique
 a| 
Une notification par e-mail est envoyée lorsque la condition majeure ou critique d'une règle d'alerte est remplie.  Les notifications ne sont pas envoyées pour les alertes mineures.



 a| 
Critique uniquement
 a| 
Une notification par e-mail est envoyée uniquement lorsque la condition critique d'une règle d'alerte est remplie.  Les notifications ne sont pas envoyées pour les alertes mineures ou majeures.

|===
. Lorsque vous êtes prêt à tester vos paramètres de messagerie, procédez comme suit :
+
.. Sélectionnez *Envoyer un e-mail de test*.
+
Un message de confirmation apparaît, indiquant qu'un e-mail de test a été envoyé.

.. Vérifiez les boîtes de réception de tous les destinataires de courrier électronique et confirmez qu’un courrier électronique de test a été reçu.
+

NOTE: Si l'e-mail n'est pas reçu dans les quelques minutes ou si l'alerte *Échec de la notification par e-mail* est déclenchée, vérifiez vos paramètres et réessayez.

.. Sign in à n’importe quel autre nœud d’administration et envoyez un e-mail de test pour vérifier la connectivité de tous les sites.
+

NOTE: Lorsque vous testez les notifications d’alerte, vous devez vous connecter à chaque nœud d’administration pour vérifier la connectivité.  Ceci est en contraste avec les tests des packages AutoSupport , où tous les nœuds d'administration envoient l'e-mail de test.



. Sélectionnez *Enregistrer*.
+
L'envoi d'un e-mail de test n'enregistre pas vos paramètres.  Vous devez sélectionner *Enregistrer*.

+
Les paramètres de messagerie sont enregistrés.





== Informations incluses dans les notifications par e-mail d'alerte

Une fois le serveur de messagerie SMTP configuré, des notifications par courrier électronique sont envoyées aux destinataires désignés lorsqu'une alerte est déclenchée, sauf si la règle d'alerte est supprimée par un silence. Voir link:silencing-alert-notifications.html["Notifications d'alerte silencieuses"] .

Les notifications par e-mail incluent les informations suivantes :

image::../media/alerts_email_notification.png[Notification par e-mail d'alertes]

[cols="1a,6a"]
|===
| Appeler | Description 


 a| 
1
 a| 
Le nom de l'alerte, suivi du nombre d'instances actives de cette alerte.



 a| 
2
 a| 
La description de l'alerte.



 a| 
3
 a| 
Toutes les actions recommandées pour l’alerte.



 a| 
4
 a| 
Détails sur chaque instance active de l'alerte, y compris le nœud et le site affectés, la gravité de l'alerte, l'heure UTC à laquelle la règle d'alerte a été déclenchée et le nom du travail et du service affectés.



 a| 
5
 a| 
Le nom d’hôte du nœud d’administration qui a envoyé la notification.

|===


== Comment les alertes sont regroupées

Pour éviter l'envoi d'un nombre excessif de notifications par e-mail lorsque des alertes sont déclenchées, StorageGRID tente de regrouper plusieurs alertes dans la même notification.

Reportez-vous au tableau suivant pour obtenir des exemples de la manière dont StorageGRID regroupe plusieurs alertes dans les notifications par courrier électronique.

[cols="1a,1a"]
|===
| Comportement | Exemple 


 a| 
Chaque notification d’alerte s’applique uniquement aux alertes portant le même nom.  Si deux alertes portant des noms différents sont déclenchées en même temps, deux notifications par e-mail sont envoyées.
 a| 
* L'alerte A est déclenchée sur deux nœuds en même temps.  Une seule notification est envoyée.
* L'alerte A est déclenchée sur le nœud 1 et l'alerte B est déclenchée sur le nœud 2 en même temps.  Deux notifications sont envoyées : une pour chaque alerte.




 a| 
Pour une alerte spécifique sur un nœud spécifique, si les seuils sont atteints pour plusieurs niveaux de gravité, une notification est envoyée uniquement pour l'alerte la plus grave.
 a| 
* L'alerte A est déclenchée et les seuils d'alerte mineure, majeure et critique sont atteints.  Une notification est envoyée pour l'alerte critique.




 a| 
La première fois qu'une alerte est déclenchée, StorageGRID attend 2 minutes avant d'envoyer une notification.  Si d'autres alertes portant le même nom sont déclenchées pendant cette période, StorageGRID regroupe toutes les alertes dans la notification initiale.
 a| 
. L'alerte A est déclenchée sur le nœud 1 à 08h00.  Aucune notification n'est envoyée.
. L'alerte A est déclenchée sur le nœud 2 à 08h01.  Aucune notification n'est envoyée.
. À 08h02, une notification est envoyée pour signaler les deux instances de l'alerte.




 a| 
Si une autre alerte portant le même nom est déclenchée, StorageGRID attend 10 minutes avant d'envoyer une nouvelle notification.  La nouvelle notification signale toutes les alertes actives (alertes actuelles qui n'ont pas été désactivées), même si elles ont été signalées précédemment.
 a| 
. L'alerte A est déclenchée sur le nœud 1 à 08h00.  Une notification est envoyée à 08h02.
. L'alerte A est déclenchée sur le nœud 2 à 08h05.  Une deuxième notification est envoyée à 08h15 (10 minutes plus tard).  Les deux nœuds sont signalés.




 a| 
S'il existe plusieurs alertes actuelles portant le même nom et que l'une de ces alertes est résolue, une nouvelle notification n'est pas envoyée si l'alerte se reproduit sur le nœud pour lequel l'alerte a été résolue.
 a| 
. L'alerte A est déclenchée pour le nœud 1.  Une notification est envoyée.
. L'alerte A est déclenchée pour le nœud 2.  Une deuxième notification est envoyée.
. L'alerte A est résolue pour le nœud 2, mais elle reste active pour le nœud 1.
. L'alerte A est à nouveau déclenchée pour le nœud 2.  Aucune nouvelle notification n'est envoyée car l'alerte est toujours active pour le nœud 1.




 a| 
StorageGRID continue d'envoyer des notifications par e-mail une fois tous les 7 jours jusqu'à ce que toutes les instances de l'alerte soient résolues ou que la règle d'alerte soit désactivée.
 a| 
. L'alerte A est déclenchée pour le nœud 1 le 8 mars.  Une notification est envoyée.
. L'alerte A n'est pas résolue ou réduite au silence.  Des notifications supplémentaires sont envoyées le 15 mars, le 22 mars, le 29 mars, etc.


|===


== Dépannage des notifications d'alerte par e-mail

Si l'alerte *Échec de la notification par e-mail* est déclenchée ou si vous ne parvenez pas à recevoir la notification par e-mail d'alerte de test, suivez ces étapes pour résoudre le problème.

.Avant de commencer
* Vous êtes connecté au Grid Manager à l'aide d'unlink:../admin/web-browser-requirements.html["navigateur Web pris en charge"] .
* Vous avez lelink:../admin/admin-group-permissions.html["Gérer les alertes ou l'autorisation d'accès root"] .


.Étapes
. Vérifiez vos paramètres.
+
.. Sélectionnez *ALERTES* > *Configuration de la messagerie électronique*.
.. Vérifiez que les paramètres du serveur de messagerie (SMTP) sont corrects.
.. Vérifiez que vous avez spécifié des adresses e-mail valides pour les destinataires.


. Vérifiez votre filtre anti-spam et assurez-vous que l’e-mail n’a pas été envoyé dans un dossier indésirable.
. Demandez à votre administrateur de messagerie de confirmer que les e-mails provenant de l'adresse de l'expéditeur ne sont pas bloqués.
. Collectez un fichier journal pour le nœud d’administration, puis contactez le support technique.
+
Le support technique peut utiliser les informations contenues dans les journaux pour aider à déterminer ce qui s’est mal passé.  Par exemple, le fichier prometheus.log peut afficher une erreur lors de la connexion au serveur que vous avez spécifié.

+
Voir link:collecting-log-files-and-system-data.html["Collecter les fichiers journaux et les données système"] .


